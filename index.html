<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Personal dashboard for organizing and managing your favorite links">
    <meta name="theme-color" content="#ffffff">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' https:; style-src 'self' 'unsafe-inline' https:; script-src 'self' https:; img-src 'self' https: data:;">
    <title>Dashboard</title>

    <!-- Favicons -->
    <link rel="icon" type="image/svg+xml" href="assets/icons/icon.svg">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/icons/icon-32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="assets/icons/icon-16.png">
    <link rel="apple-touch-icon" sizes="192x192" href="assets/icons/icon-192.png">
    <link rel="shortcut icon" href="favicon.ico">

    <link rel="manifest" href="manifest.json">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/fontawesome-all.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <div class="header-content">
            <h1>Dashboard</h1>
            <div class="header-actions">
                <!-- Quick Actions -->
                <button id="themeColorBtn" title="Change Theme Color" class="header-btn">
                    <i class="fas fa-palette"></i>
                </button>
                <button id="darkModeBtn" title="Toggle Dark Mode" class="header-btn">
                    <i class="fas fa-moon"></i>
                </button>

                <span class="header-divider"></span>

                <!-- Primary Features -->
                <button id="notesBtn" title="Quick Notes (Ctrl+Shift+N)" class="header-btn">
                    <i class="fas fa-sticky-note"></i>
                </button>
                <button id="todoListBtn" title="Tasks" class="header-btn">
                    <i class="fas fa-tasks"></i>
                </button>
                <button id="retirementTimerBtn" title="Retirement Timer" class="header-btn">
                    <i class="fas fa-hourglass-half"></i>
                </button>

                <span class="header-divider"></span>

                <!-- Settings & Help -->
                <div class="header-menu-container">
                    <button id="headerMenuBtn" title="Settings & More" class="header-btn" aria-haspopup="true" aria-expanded="false">
                        <i class="fas fa-ellipsis-v"></i>
                    </button>
                    <div id="headerMenu" class="header-dropdown-menu" role="menu" aria-hidden="true">
                        <button class="menu-item" id="menuSettingsBtn" role="menuitem">
                            <i class="fas fa-user-edit"></i>
                            <span>Change Username</span>
                        </button>
                        <div class="menu-divider"></div>
                        <button class="menu-item" id="menuImportBtn" role="menuitem">
                            <i class="fas fa-file-arrow-down"></i>
                            <span>Import Data</span>
                        </button>
                        <button class="menu-item" id="menuExportBtn" role="menuitem">
                            <i class="fas fa-file-export"></i>
                            <span>Export Data</span>
                        </button>
                        <button class="menu-item" id="menuBackupBtn" role="menuitem">
                            <i class="fas fa-cogs"></i>
                            <span>Backup Settings</span>
                        </button>
                        <div class="menu-divider"></div>
                        <button class="menu-item" id="menuUndoBtn" role="menuitem">
                            <i class="fas fa-undo"></i>
                            <span>Undo</span>
                        </button>
                        <div class="menu-divider"></div>
                        <button class="menu-item menu-item-danger" id="menuClearBtn" role="menuitem">
                            <i class="fas fa-trash-alt"></i>
                            <span>Clear Storage</span>
                        </button>
                    </div>
                </div>
                <button id="helpBtn" title="Help" class="header-btn" aria-label="Help and Documentation">
                    <i class="fas fa-question-circle"></i>
                </button>
            </div>
        </div>
    </header>

    <main role="main" aria-label="Dashboard Content">
        <div class="form-container" role="form" aria-label="Add Content Forms">
            <form id="addSectionForm">
                <h3 class="form-title">Add New Section</h3>
                <input type="text" id="newSectionName" placeholder="Section name" required
                       aria-label="New Section Name" pattern="[A-Za-z0-9\s\-_]+"
                       title="Only letters, numbers, spaces, hyphens and underscores allowed">
                <button type="submit">Add Section</button>
            </form>

            <form id="addLinkForm">
                <h3 class="form-title">Add New Link</h3>
                <select id="existingSections" required>
                    <option value="">Select section</option>
                </select>
                <input type="text" id="linkName" placeholder="Link name" required
                       aria-label="Link Name" pattern="[A-Za-z0-9\s\-_]+"
                       title="Only letters, numbers, spaces, hyphens and underscores allowed">
                <input type="url" id="linkUrl" placeholder="Link URL" required
                       aria-label="Link URL" pattern="https?://.+"
                       title="URL must start with http:// or https://">
                <button type="submit">Add Link</button>
            </form>
        </div>

        <div class="search-container">
            <input type="text" id="searchInput" placeholder="Search links..."
                   aria-label="Search Links" role="searchbox">
            <button type="button" id="clearSearchBtn" aria-label="Clear search">
                <i class="fas fa-times"></i>
            </button>
        </div>

        <div id="favoritesSection" class="section">
            <h2>Favorites</h2>
            <div id="favoritesList" class="link-list"></div>
        </div>

        <!-- Retirement Timer Section (Hidden by default) -->
        <div id="retirementTimerContainer" class="section" style="display: none;">
            <div class="section-header">
                <h2 class="section-title">Retirement Countdown</h2>
                <div class="section-actions">
                    <button id="retirementSettingsBtn" class="section-btn" title="Settings">
                        <i class="fas fa-cog"></i>
                    </button>
                    <button id="retirementToggleBtn" class="section-btn" title="Enable/Disable Timer">
                        <i class="fas fa-toggle-off"></i>
                    </button>
                </div>
            </div>
            <div class="retirement-content">
                <div id="retirementTimer" class="timer-display">Timer loading...</div>
            </div>
        </div>

        <div id="linkList"></div>
    </main>

    <input type="file" id="importInput" style="display: none;" accept=".json,.html">

    <!-- Hidden buttons for backward compatibility with script.js -->
    <button id="importBtn" style="display: none;"></button>
    <button id="exportAllBtn" style="display: none;"></button>
    <button id="settingsBtn" style="display: none;"></button>
    <button id="undoBtn" style="display: none;"></button>
    <button id="clearStorageBtn" style="display: none;"></button>
    <button id="backupSettingsBtn" style="display: none;"></button>

    <!-- Custom Modal Dialog -->
    <div id="customModal" class="modal" style="display: none;" role="dialog" aria-labelledby="modalTitle" aria-modal="true">
        <div class="modal-content" role="document">
            <h3 id="modalTitle" class="modal-title">Modal Title</h3>
            <p id="modalMessage" class="modal-message">Modal content goes here.</p>
            <div class="modal-buttons">
                <button id="modalNo" class="modal-btn" autofocus>No</button>
                <button id="modalYes" class="modal-btn primary">Yes</button>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.14.0/Sortable.min.js"></script>
    <script src="js/core/logger.js"></script>
    <script src="js/core/theme.js"></script>
    <script src="js/core/export-utils.js"></script>
    <script src="js/core/keyboard-nav.js"></script>
    <script src="js/features/retirement/auto-backup.js"></script>
    <script src="js/core/input-validator.js"></script>
    <script src="js/core/error-handler.js"></script>
    <script src="js/core/modal-manager.js"></script>
    <script src="js/features/notes/notes.js"></script>
    <script src="js/features/notes/notes-ui.js"></script>
    <script src="js/features/dashboard/script.js"></script>
    <script src="js/features/retirement/retirement-timer.js"></script>
    <script>
        // Register service worker for offline functionality
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/js/sw.js')
                .then(registration => {
                    console.log('ServiceWorker registration successful');
                })
                .catch(err => {
                    console.error('ServiceWorker registration failed:', err);
                });
        }
    </script>
</body>
</html>
